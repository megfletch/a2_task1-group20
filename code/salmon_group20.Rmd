---
title: "Salmon-Group20"
author: "Meghan Fletcher"
date: "2/4/2021"
output: 
  html_document:
    code_folding: hide
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)

library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(patchwork)
library(prettydoc)

# For time series data
library(tsibble)
library(feasts)
library(fable)
library(urca)
```

# Tab 1: Time Series of salmon passage
```{r}
# Read in data
fish_data <- read_csv(here("data", "willamette_fish_passage.csv")) %>% 
  clean_names()

# Select for coho, jack coho and steelhead
fish_clean <- fish_data %>% 
  select("date", "steelhead", "coho", "jack_coho") %>% 
  mutate(across(where(is.numeric), ~ ifelse(is.na(.), 0, .)))
```

```{r}
# Wrangle data in preparation for time series
fish_ts <- fish_clean %>% 
  mutate(date = lubridate::myd(date)) %>% 
  as_tsibble(key = NULL, index = date) 
```

```{r, fig.cap="**Figure 1:** This graph shows that trend in steelhead salmon migration through the Columbia River and gives projections to 2031."}
# Steelhead salmon
ggplot(data = fish_ts, aes(x = date, y = steelhead, color = steelhead)) +
  geom_line(color = "palegreen4") +
  theme_minimal() +
  labs(x = "Year", y = "Steelhead Salmon", title = "Steelhead Salmon Passage over Time")
```

```{r, fig.cap="**Figure 2:** This graph shows that trend in coho salmon migration through the Columbia River and gives projections to 2031."}
# Coho slamon
ggplot(data = fish_ts, aes(x = date, y = coho, color = coho)) +
  geom_line(color = "red3") +
  theme_minimal() +
  labs(x = "Year", y = "Coho Salmon", title = "Coho Salmon Passage over Time")
```

```{r, fig.cap="**Figure 3:** This graph shows that trend in jack coho salmon migration through the Columbia River and gives projections to 2031."}
# Jack Coho salmon
ggplot(data = fish_ts, aes(x = date, y = jack_coho, color = jack_coho)) +
  geom_line(color = "orange1") +
  theme_minimal()+
  labs(x = "Year", y = "Jack Coho Salmon", title = "Jack Coho Salmon Passage over Time")
```
From the times series graphs on steelhead, coho and jack coho salmon, we can see that:

1. All three types of salmon pass have strong, seasonal migratory patterns through the Columbia River.

2. Steelhead salmon numbers have remained relatively constant and are predicted to remain constant through 2030 while coho and jack coho salmon numbers are expected to increase.

3. Steelhead salmon spend a greater time on average in the Columbia River than do either of the other two species. 
